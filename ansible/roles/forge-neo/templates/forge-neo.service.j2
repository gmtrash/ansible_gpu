[Unit]
Description=Stable Diffusion WebUI Forge Neo
After=network.target

[Service]
Type=simple
User={{ ansible_user }}
WorkingDirectory={{ forge_install_dir }}/app
Environment="PYENV_ROOT={{ ansible_env.HOME }}/.pyenv"
Environment="PATH={{ ansible_env.HOME }}/.pyenv/shims:{{ ansible_env.HOME }}/.pyenv/bin:{{ ansible_env.HOME }}/.cargo/bin:/usr/local/cuda-12.8/bin:{{ ansible_env.PATH }}"
Environment="LD_LIBRARY_PATH=/usr/local/cuda-12.8/lib64"
Environment="PYTHONUNBUFFERED=1"
ExecStart={{ forge_install_dir }}/app/venv/bin/python3 launch.py --listen --port 7860 --skip-python-version-check
Restart=on-failure
RestartSec=10
StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target
